{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Language Learning Platform</title>
    <link rel="stylesheet" href="{% static 'home/styles.css' %}">
  </head>
  <body>
    <header>
      <nav class="navbar">
        <div class="nav-brand">
          <h1>Language Learning Platform</h1>
        </div>
        <button class="nav-toggle" aria-label="Toggle navigation">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <ul class="nav-menu">
          <li class="nav-item"><a href="{% url 'landing' %}" class="nav-link">Home</a></li>
          <li class="nav-item"><a href="#" class="nav-link">Courses</a></li>
          <li class="nav-item"><a href="#" class="nav-link">Lessons</a></li>
          <li class="nav-item"><a href="{% url 'progress' %}" class="nav-link">My Progress</a></li>
          <li class="nav-item"><a href="{% url 'login' %}" class="nav-link active">Login</a></li>
          <li class="nav-item"><a href="#" class="nav-link nav-button">Sign Up</a></li>
        </ul>
      </nav>
    </header>
    
    <main>
      <div class="auth-container">
        <div class="auth-box">
          <div class="auth-tabs">
            <button class="auth-tab active" data-tab="login">Login</button>
            <button class="auth-tab" data-tab="signup">Create Account</button>
          </div>
          
          <!-- Django Messages -->
          {% if messages %}
            <div class="messages-container">
              {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                  {{ message }}
                </div>
              {% endfor %}
            </div>
          {% endif %}
          
          <!-- Login Form -->
          <form id="login-form" class="auth-form active" method="POST" action="{% url 'login' %}">
            {% csrf_token %}
            <h2>Welcome Back!</h2>
            <p class="auth-subtitle">Login to continue your learning journey</p>
            
            <div class="form-group">
              <label for="login-username-or-email">Username or Email</label>
              <input
                type="text"
                id="login-username-or-email"
                name="username_or_email"
                required
                maxlength="254"
                pattern="[a-zA-Z0-9@._+\-]+"
                placeholder="Enter your username or email"
                title="Use only letters, numbers, and @._+- characters"
              >
              <small class="form-hint">You can log in with either your username or email address</small>
            </div>
            
            <div class="form-group">
              <label for="login-password">Password</label>
              <input 
                type="password" 
                id="login-password" 
                name="password" 
                required 
                placeholder="Enter your password"
              >
            </div>
            
            <div class="form-options">
              <label class="checkbox-label">
                <input type="checkbox" name="remember">
                <span>Remember me</span>
              </label>
              <a href="{% url 'forgot_password' %}" class="forgot-password">Forgot Password?</a>
            </div>

            <div class="form-options form-options-compact">
              <a href="{% url 'forgot_username' %}" class="forgot-password forgot-username-link">Forgot Username?</a>
            </div>
            
            <button type="submit" class="auth-button">Login</button>
            
            <p class="auth-switch">
              Don't have an account? 
              <a href="#" class="switch-link" data-switch="signup">Create one now</a>
            </p>
          </form>
          
          <!-- Signup Form -->
          <form id="signup-form" class="auth-form" method="POST" action="{% url 'signup' %}">
            {% csrf_token %}
            <h2>Create Account</h2>
            <p class="auth-subtitle">Start your language learning adventure today</p>
            
            <div class="form-group">
              <label for="signup-name">Full Name</label>
              <input 
                type="text" 
                id="signup-name" 
                name="name" 
                required 
                placeholder="Enter your full name"
              >
            </div>
            
            <div class="form-group">
              <label for="signup-email">Email Address</label>
              <input 
                type="email" 
                id="signup-email" 
                name="email" 
                required 
                placeholder="Enter your email"
              >
            </div>
            
            <div class="form-group">
              <label for="signup-password">Password</label>
              <input 
                type="password" 
                id="signup-password" 
                name="password" 
                required 
                placeholder="Create a password"
                minlength="8"
              >
              <small class="form-hint">Must be at least 8 characters</small>
            </div>
            
            <div class="form-group">
              <label for="signup-confirm-password">Confirm Password</label>
              <input 
                type="password" 
                id="signup-confirm-password" 
                name="confirm-password" 
                required 
                placeholder="Confirm your password"
              >
            </div>
            
            <div class="form-options">
              <label class="checkbox-label">
                <input type="checkbox" name="terms" required>
                <span>I agree to the Terms of Service and Privacy Policy</span>
              </label>
            </div>
            
            <button type="submit" class="auth-button">Create Account</button>
            
            <p class="auth-switch">
              Already have an account? 
              <a href="#" class="switch-link" data-switch="login">Login here</a>
            </p>
          </form>
        </div>
      </div>
    </main>
    
    <footer>
      <p>&copy; 2025 Language Learning Platform. Start learning today!</p>
    </footer>

    <script>
      // Mobile menu toggle
      const navToggle = document.querySelector('.nav-toggle');
      const navMenu = document.querySelector('.nav-menu');
      
      navToggle.addEventListener('click', () => {
        navMenu.classList.toggle('active');
        navToggle.classList.toggle('active');
      });

      // Close menu when clicking outside
      document.addEventListener('click', (e) => {
        if (!navToggle.contains(e.target) && !navMenu.contains(e.target)) {
          navMenu.classList.remove('active');
          navToggle.classList.remove('active');
        }
      });

      // Auth form switching
      const authTabs = document.querySelectorAll('.auth-tab');
      const authForms = document.querySelectorAll('.auth-form');
      const switchLinks = document.querySelectorAll('.switch-link');

      function switchForm(formType) {
        authTabs.forEach(tab => {
          tab.classList.toggle('active', tab.dataset.tab === formType);
        });
        
        authForms.forEach(form => {
          form.classList.toggle('active', form.id === `${formType}-form`);
        });
      }

      authTabs.forEach(tab => {
        tab.addEventListener('click', () => {
          switchForm(tab.dataset.tab);
        });
      });

      switchLinks.forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          switchForm(link.dataset.switch);
        });
      });

      // Client-side password match validation for signup
      const signupForm = document.getElementById('signup-form');
      
      signupForm.addEventListener('submit', (e) => {
        const password = document.getElementById('signup-password').value;
        const confirmPassword = document.getElementById('signup-confirm-password').value;
        
        if (password !== confirmPassword) {
          e.preventDefault();
          alert('Passwords do not match!');
          return false;
        }
      });
    </script>
  </body>
</html>
{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Language Learning Platform</title>
    {% if IS_DEVEDU %}<base href="/proxy/8000{{ request.path }}{% if not request.path|slice:'-1:' == '/' %}/{% endif %}">{% endif %}
    <link rel="stylesheet" href="{% static 'home/css/base.css' %}">
    <link rel="stylesheet" href="{% static 'home/css/components.css' %}">
    <link rel="stylesheet" href="{% static 'home/css/pages.css' %}">
    <link rel="stylesheet" href="{% static 'home/css/animations.css' %}">
    <link rel="stylesheet" href="{% static 'home/css/utilities.css' %}">
  </head>
  <body>
    {% include '_nav.html' %}
    
    <div class="auth-container fade-in">
      <div class="auth-card zoom-in">
        <!-- Tabs -->
        <div class="tabs">
          <button class="tab active" data-tab="login">Login</button>
          <button class="tab" data-tab="signup">Create Account</button>
        </div>
        
        <!-- Django Messages -->
        {% if messages %}
          <div style="padding: var(--space-xl);">
            {% for message in messages %}
              <div class="alert alert-{{ message.tags }}">
                {{ message }}
              </div>
            {% endfor %}
          </div>
        {% endif %}
        
        <!-- Login Form -->
        <div id="login-content" class="tab-content active">
          <div class="auth-card-header">
            {% if not messages %}
            <h2>Welcome Back!</h2>
            <p class="auth-card-subtitle">Login to continue your learning journey</p>
            {% else %}
            <h2>Login</h2>
            <p class="auth-card-subtitle">Please check your credentials and try again</p>
            {% endif %}
          </div>

          <form method="POST" action="{% url 'login' %}" class="auth-card-body">
            {% csrf_token %}
            
            <div class="form-group">
              <div class="flex justify-between items-center mb-sm">
                <label for="login-username-or-email" class="form-label">Username or Email</label>
                <a href="{% url 'forgot_username' %}" class="auth-link text-sm">Forgot Username?</a>
              </div>
              <input
                type="text"
                id="login-username-or-email"
                name="username_or_email"
                class="form-input"
                required
                maxlength="254"
                pattern="[a-zA-Z0-9@._+\-]+"
                placeholder="Enter your username or email"
                title="Use only letters, numbers, and @._+- characters"
              >
            </div>
            
            <div class="form-group">
              <div class="flex justify-between items-center mb-sm">
                <label for="login-password" class="form-label">Password</label>
                <a href="{% url 'forgot_password' %}" class="auth-link text-sm">Forgot Password?</a>
              </div>
              <input 
                type="password" 
                id="login-password" 
                name="password" 
                class="form-input"
                required 
                placeholder="Enter your password"
              >
            </div>
            
            <div class="mb-lg">
              <label class="form-check-label">
                <input type="checkbox" name="remember" class="form-checkbox">
                Remember me
              </label>
            </div>
            
            <button type="submit" class="btn btn-primary btn-full btn-lg">Login</button>
          </form>

          <div class="auth-footer">
            <p>
              Don't have an account? 
              <a href="#" class="auth-link switch-link" data-switch="signup">Create one now</a>
            </p>
          </div>
        </div>
        
        <!-- Signup Form -->
        <div id="signup-content" class="tab-content">
          <div class="auth-card-header">
            <h2>Create Account</h2>
            <p class="auth-card-subtitle">Start your language learning adventure today</p>
          </div>

          <form method="POST" action="{% url 'signup' %}" id="signup-form" class="auth-card-body">
            {% csrf_token %}
            
            <div class="form-group">
              <label for="signup-name" class="form-label">Full Name</label>
              <input 
                type="text" 
                id="signup-name" 
                name="name" 
                class="form-input"
                required 
                placeholder="Enter your full name"
              >
            </div>
            
            <div class="form-group">
              <label for="signup-email" class="form-label">Email Address</label>
              <input 
                type="email" 
                id="signup-email" 
                name="email" 
                class="form-input"
                required 
                placeholder="Enter your email"
              >
            </div>
            
            <div class="form-group">
              <label for="signup-password" class="form-label">Password</label>
              <input 
                type="password" 
                id="signup-password" 
                name="password" 
                class="form-input"
                required 
                placeholder="Create a password"
                minlength="8"
              >
              <small class="form-hint">Must be at least 8 characters</small>
            </div>
            
            <div class="form-group">
              <label for="signup-confirm-password" class="form-label">Confirm Password</label>
              <input 
                type="password" 
                id="signup-confirm-password" 
                name="confirm-password" 
                class="form-input"
                required 
                placeholder="Confirm your password"
              >
            </div>
            
            <div class="form-group">
              <label class="form-check-label">
                <input type="checkbox" name="terms" class="form-checkbox" required>
                I agree to the Terms of Service and Privacy Policy
              </label>
            </div>
            
            <button type="submit" class="btn btn-primary btn-full btn-lg">Create Account</button>
          </form>

          <div class="auth-footer">
            <p>
              Already have an account? 
              <a href="#" class="auth-link switch-link" data-switch="login">Login here</a>
            </p>
          </div>
        </div>
      </div>
    </div>
    
    <footer>
      <p>&copy; 2025 Language Learning Platform. Empowering language learners worldwide.</p>
    </footer>

    <script>
      // Mobile menu toggle
      const navToggle = document.querySelector('.nav-toggle');
      const navCenter = document.querySelector('.nav-center');
      
      if (navToggle && navCenter) {
        navToggle.addEventListener('click', () => {
          navCenter.classList.toggle('active');
          navToggle.classList.toggle('active');
        });

        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
          if (!navToggle.contains(e.target) && !navCenter.contains(e.target)) {
            navCenter.classList.remove('active');
            navToggle.classList.remove('active');
          }
        });
      }

      // Tab switching
      const tabs = document.querySelectorAll('.tab');
      const tabContents = document.querySelectorAll('.tab-content');
      const switchLinks = document.querySelectorAll('.switch-link');

      function switchTab(tabName) {
        tabs.forEach(tab => {
          tab.classList.toggle('active', tab.dataset.tab === tabName);
        });
        
        tabContents.forEach(content => {
          content.classList.toggle('active', content.id === `${tabName}-content`);
        });
      }

      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          switchTab(tab.dataset.tab);
        });
      });

      switchLinks.forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          switchTab(link.dataset.switch);
        });
      });

      // Client-side password match validation for signup
      const signupForm = document.getElementById('signup-form');
      
      if (signupForm) {
        signupForm.addEventListener('submit', (e) => {
          const password = document.getElementById('signup-password').value;
          const confirmPassword = document.getElementById('signup-confirm-password').value;
          
          if (password !== confirmPassword) {
            e.preventDefault();
            alert('Passwords do not match!');
            return false;
          }
        });
      }
    </script>
  </body>
</html>
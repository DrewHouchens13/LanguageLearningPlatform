<!--
ü§ñ AI ASSISTANT INSTRUCTIONS - DYNAMIC LANGUAGE SELECTION PAGE
================================================================================

PURPOSE:
This template displays the main lessons page with language selection buttons.
It AUTOMATICALLY detects all available languages and displays them - no
hardcoding required!

HOW IT WORKS:
1. Backend (home/views.py:lessons_list) queries database for all published lessons
2. Groups lessons by language and adds metadata (native names, flags)
3. Passes 'languages_with_lessons' list to this template
4. Template loops through and creates a button for each language

TEMPLATE VARIABLES RECEIVED:
- languages_with_lessons: List of dicts, each containing:
  - name: English name (e.g., 'Spanish')
  - native_name: Native language name (e.g., 'Espa√±ol')
  - flag: Flag emoji (e.g., 'üá™üá∏')
  - lesson_count: Number of lessons available
  - lessons: QuerySet of lesson objects

BUTTON BEHAVIOR:
- Each button links to /lessons/{language_lowercase}/
- Example: "üá™üá∏ Espa√±ol" button ‚Üí /lessons/spanish/
- URL routing handled by home/urls.py

‚ö†Ô∏è CRITICAL URL ROUTING REQUIREMENT:
The URL patterns in home/urls.py MUST be in the correct order:
  1. lessons/<int:lesson_id>/     ‚Üê FIRST (specific pattern)
  2. lessons/<str:language>/      ‚Üê SECOND (general pattern)

If reversed, lesson detail pages will break! See home/urls.py for full explanation.

HOW TO ADD A NEW LANGUAGE (For AI Assistants):
1. Add metadata to LANGUAGE_METADATA in home/language_registry.py
2. Create lessons in database with language='YourLanguage'
3. This template will automatically display the new language button
4. NO template changes needed!

EXAMPLE - Adding French:
Backend: Add to LANGUAGE_METADATA: 'French': {'native_name': 'Fran√ßais', 'flag': 'üá´üá∑', 'speech_code': 'fr-FR'}
Database: Create lessons with language='French'
Result: Template automatically shows "üá´üá∑ Fran√ßais" button

RELATED FILES:
- home/views.py (lessons_list function) - Provides data
- home/urls.py - URL routing
- home/templates/lessons/lessons_by_language.html - Language-specific pages

================================================================================
-->
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lessons - Language Learning Platform</title>
    {% if IS_DEVEDU %}<base href="/proxy/8000{{ request.path }}{% if not request.path|slice:'-1:' == '/' %}/{% endif %}">{% endif %}
    <link rel="stylesheet" href="{% static 'home/css/base.css' %}">
    <link rel="stylesheet" href="{% static 'home/css/components.css' %}">
    <link rel="stylesheet" href="{% static 'home/css/pages.css' %}">
    <link rel="stylesheet" href="{% static 'home/css/animations.css' %}">
    <link rel="stylesheet" href="{% static 'home/css/utilities.css' %}">
</head>
<body>
    {% include '_nav.html' %}

    <main class="container" style="padding-top: var(--space-3xl);">
        {% if not user.is_authenticated %}
        <!-- Guest View - Login Required -->
        <div class="text-center fade-in" style="padding: var(--space-4xl) 0;">
            <div class="empty-state">
                <div class="empty-state-icon">üîí</div>
                <h2 class="text-5xl font-black mb-lg">Premium Lessons Await</h2>
                <p class="lead mb-xl">Our interactive language lessons are exclusively available to registered members.<br>Complete your placement test to unlock personalized learning content!</p>
                <div class="flex gap-lg justify-center flex-wrap">
                    <a href="{% url 'login' %}" class="btn btn-primary btn-lg">
                        Login to Access Lessons
                    </a>
                    <a href="{% url 'onboarding_welcome' %}" class="btn btn-accent btn-lg">
                        Take Placement Test
                    </a>
                </div>
            </div>
        </div>
        {% else %}
        <!-- Logged In User View -->
        <!-- Header -->
        <div class="lessons-header fade-in text-center" style="margin-bottom: var(--space-3xl);">
            <h2 style="font-size: var(--font-size-4xl); font-weight: 800;">Choose Your Language</h2>
            <p style="font-size: var(--font-size-lg); color: var(--color-text-muted);">Select a language to explore lessons</p>
        </div>

        {% if languages_with_lessons %}
            <!-- Language Selection Buttons (ONLY BUTTONS, NO LESSONS) -->
            <div class="fade-in-up">
                <div style="display: flex; flex-wrap: wrap; gap: var(--space-md); justify-content: center; max-width: 600px; margin: 0 auto;">
                    {% for language in languages_with_lessons %}
                    <a href="{% if IS_DEVEDU %}../lessons/{{ language.name|lower }}/{% else %}{% url 'lessons_by_language' language.name|lower %}{% endif %}"
                       class="btn btn-primary"
                       style="text-decoration: none;">
                        {{ language.flag }} {{ language.native_name }}
                    </a>
                    {% endfor %}
                </div>
            </div>

        {% else %}
            <!-- No Lessons Available -->
            <div class="empty-state">
                <div class="empty-state-icon">üìö</div>
                <h3>No Lessons Available Yet</h3>
                <p>Check back soon for new learning content!</p>
            </div>
        {% endif %}
        {% endif %}
    </main>

    <footer>
      <p>&copy; 2025 Language Learning Platform. Empowering language learners worldwide.</p>
    </footer>

    <script>
      // Smooth scroll to language section
      function scrollToLanguage(language) {
        const element = document.getElementById('language-' + language);
        if (element) {
          element.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }

      // Mobile menu toggle
      const navToggle = document.querySelector('.nav-toggle');
      const navCenter = document.querySelector('.nav-center');

      if (navToggle && navCenter) {
        navToggle.addEventListener('click', () => {
          navCenter.classList.toggle('active');
          navToggle.classList.toggle('active');
        });

        document.addEventListener('click', (e) => {
          if (!navToggle.contains(e.target) && !navCenter.contains(e.target)) {
            navCenter.classList.remove('active');
            navToggle.classList.remove('active');
          }
        });
      }

      // Hover effect for language cards
      const languageCards = document.querySelectorAll('.card[onclick]');
      languageCards.forEach(card => {
        card.addEventListener('mouseenter', () => {
          card.style.transform = 'translateY(-4px)';
          card.style.boxShadow = '0 8px 16px rgba(0,0,0,0.1)';
        });
        card.addEventListener('mouseleave', () => {
          card.style.transform = 'translateY(0)';
          card.style.boxShadow = '';
        });
      });
    </script>
</body>
</html>
